{"version":3,"file":"shared-BHaeMcAC.js","sources":["../src/hooks/internal/useResizeObserver.ts","../src/hooks/internal/useObservableState.ts","../src/context/chat-context.ts","../src/context/pin-context.ts","../src/context/layout-context.ts","../src/context/track-reference-context.ts","../src/context/participant-context.ts","../../../node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs","../src/mergeProps.ts","../src/hooks/useConnectionQualityIndicator.ts","../src/hooks/useConnectionStatus.ts","../src/hooks/useDisconnectButton.ts","../src/hooks/useFacingMode.ts","../src/hooks/useFocusToggle.ts","../src/hooks/useGridLayout.ts","../src/hooks/useIsMuted.ts","../src/hooks/useIsSpeaking.ts","../src/utils.ts","../src/hooks/useLocalParticipantPermissions.ts","../src/hooks/useMediaDeviceSelect.ts","../src/hooks/useMediaDevices.ts","../src/hooks/useVisualStableUpdate.ts","../src/hooks/usePagination.ts","../src/hooks/useParticipantTile.ts","../src/hooks/usePinnedTracks.ts","../src/hooks/useStartAudio.ts","../src/hooks/useStartVideo.ts","../src/hooks/useSwipe.ts","../src/hooks/useChatToggle.ts","../src/hooks/useTrackMutedIndicator.ts","../src/hooks/useTrackToggle.ts","../src/hooks/useTracks.ts","../src/hooks/useChat.ts","../src/hooks/usePersistentUserChoices.ts","../src/hooks/useIsEncrypted.ts","../src/hooks/useTrackVolume.ts"],"sourcesContent":["/* eslint-disable no-return-assign */\r\n/* eslint-disable no-underscore-dangle */\r\nimport * as React from 'react';\r\n\r\nconst useLatest = <T>(current: T) => {\r\n  const storedValue = React.useRef(current);\r\n  React.useEffect(() => {\r\n    storedValue.current = current;\r\n  });\r\n  return storedValue;\r\n};\r\n\r\n/**\r\n * A React hook that fires a callback whenever ResizeObserver detects a change to its size\r\n * code extracted from https://github.com/jaredLunde/react-hook/blob/master/packages/resize-observer/src/index.tsx in order to not include the polyfill for resize-observer\r\n *\r\n * @internal\r\n */\r\nexport function useResizeObserver<T extends HTMLElement>(\r\n  target: React.RefObject<T>,\r\n  callback: UseResizeObserverCallback,\r\n) {\r\n  const resizeObserver = getResizeObserver();\r\n  const storedCallback = useLatest(callback);\r\n\r\n  React.useLayoutEffect(() => {\r\n    let didUnsubscribe = false;\r\n\r\n    const targetEl = target.current;\r\n    if (!targetEl) return;\r\n\r\n    function cb(entry: ResizeObserverEntry, observer: ResizeObserver) {\r\n      if (didUnsubscribe) return;\r\n      storedCallback.current(entry, observer);\r\n    }\r\n\r\n    resizeObserver?.subscribe(targetEl as HTMLElement, cb);\r\n\r\n    return () => {\r\n      didUnsubscribe = true;\r\n      resizeObserver?.unsubscribe(targetEl as HTMLElement, cb);\r\n    };\r\n  }, [target.current, resizeObserver, storedCallback]);\r\n\r\n  return resizeObserver?.observer;\r\n}\r\n\r\nfunction createResizeObserver() {\r\n  let ticking = false;\r\n  let allEntries: ResizeObserverEntry[] = [];\r\n\r\n  const callbacks: Map<unknown, Array<UseResizeObserverCallback>> = new Map();\r\n\r\n  if (typeof window === 'undefined') {\r\n    return;\r\n  }\r\n\r\n  const observer = new ResizeObserver((entries: ResizeObserverEntry[], obs: ResizeObserver) => {\r\n    allEntries = allEntries.concat(entries);\r\n    if (!ticking) {\r\n      window.requestAnimationFrame(() => {\r\n        const triggered = new Set<Element>();\r\n        for (let i = 0; i < allEntries.length; i++) {\r\n          if (triggered.has(allEntries[i].target)) continue;\r\n          triggered.add(allEntries[i].target);\r\n          const cbs = callbacks.get(allEntries[i].target);\r\n          cbs?.forEach((cb) => cb(allEntries[i], obs));\r\n        }\r\n        allEntries = [];\r\n        ticking = false;\r\n      });\r\n    }\r\n    ticking = true;\r\n  });\r\n\r\n  return {\r\n    observer,\r\n    subscribe(target: HTMLElement, callback: UseResizeObserverCallback) {\r\n      observer.observe(target);\r\n      const cbs = callbacks.get(target) ?? [];\r\n      cbs.push(callback);\r\n      callbacks.set(target, cbs);\r\n    },\r\n    unsubscribe(target: HTMLElement, callback: UseResizeObserverCallback) {\r\n      const cbs = callbacks.get(target) ?? [];\r\n      if (cbs.length === 1) {\r\n        observer.unobserve(target);\r\n        callbacks.delete(target);\r\n        return;\r\n      }\r\n      const cbIndex = cbs.indexOf(callback);\r\n      if (cbIndex !== -1) cbs.splice(cbIndex, 1);\r\n      callbacks.set(target, cbs);\r\n    },\r\n  };\r\n}\r\n\r\nlet _resizeObserver: ReturnType<typeof createResizeObserver>;\r\n\r\nconst getResizeObserver = () =>\r\n  !_resizeObserver ? (_resizeObserver = createResizeObserver()) : _resizeObserver;\r\n\r\nexport type UseResizeObserverCallback = (\r\n  entry: ResizeObserverEntry,\r\n  observer: ResizeObserver,\r\n) => unknown;\r\n\r\nexport const useSize = (target: React.RefObject<HTMLDivElement>) => {\r\n  const [size, setSize] = React.useState({ width: 0, height: 0 });\r\n  React.useLayoutEffect(() => {\r\n    if (target.current) {\r\n      const { width, height } = target.current.getBoundingClientRect();\r\n      setSize({ width, height });\r\n    }\r\n  }, [target.current]);\r\n\r\n  const resizeCallback = React.useCallback(\r\n    (entry: ResizeObserverEntry) => setSize(entry.contentRect),\r\n    [],\r\n  );\r\n  // Where the magic happens\r\n  useResizeObserver(target, resizeCallback);\r\n  return size;\r\n};\r\n","import * as React from 'react';\r\n// @ts-ignore\r\nimport type { Observable } from 'rxjs';\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function useObservableState<T>(\r\n  observable: Observable<T> | undefined,\r\n  startWith: T,\r\n  resetWhenObservableChanges = true,\r\n) {\r\n  const [state, setState] = React.useState<T>(startWith);\r\n  React.useEffect(() => {\r\n    if (resetWhenObservableChanges) {\r\n      setState(startWith);\r\n    }\r\n    // observable state doesn't run in SSR\r\n    if (typeof window === 'undefined' || !observable) return;\r\n    const subscription = observable.subscribe(setState);\r\n    return () => subscription.unsubscribe();\r\n  }, [observable, resetWhenObservableChanges]);\r\n  return state;\r\n}\r\n","import type { WidgetState } from '@livekit/components-core';\r\nimport type * as React from 'react';\r\n\r\n/** @internal */\r\nexport type ChatContextAction =\r\n  | { msg: 'show_chat' }\r\n  | { msg: 'hide_chat' }\r\n  | { msg: 'toggle_chat' }\r\n  | { msg: 'unread_msg'; count: number }\r\n  | { msg: 'toggle_settings' };\r\n\r\n/** @internal */\r\nexport type WidgetContextType = {\r\n  dispatch?: React.Dispatch<ChatContextAction>;\r\n  state?: WidgetState;\r\n};\r\n\r\n/** @internal */\r\nexport function chatReducer(state: WidgetState, action: ChatContextAction): WidgetState {\r\n  if (action.msg === 'show_chat') {\r\n    return { ...state, showChat: true, unreadMessages: 0 };\r\n  } else if (action.msg === 'hide_chat') {\r\n    return { ...state, showChat: false };\r\n  } else if (action.msg === 'toggle_chat') {\r\n    const newState = { ...state, showChat: !state.showChat };\r\n    if (newState.showChat === true) {\r\n      newState.unreadMessages = 0;\r\n    }\r\n    return newState;\r\n  } else if (action.msg === 'unread_msg') {\r\n    return { ...state, unreadMessages: action.count };\r\n  } else if (action.msg === 'toggle_settings') {\r\n    return { ...state, showSettings: !state.showSettings };\r\n  } else {\r\n    return { ...state };\r\n  }\r\n}\r\n","import type { PinState, TrackReferenceOrPlaceholder } from '@livekit/components-core';\r\nimport type * as React from 'react';\r\n\r\n/** @internal */\r\nexport type PinAction =\r\n  | {\r\n      msg: 'set_pin';\r\n      trackReference: TrackReferenceOrPlaceholder;\r\n    }\r\n  | { msg: 'clear_pin' };\r\n\r\n/** @internal */\r\nexport type PinContextType = {\r\n  dispatch?: React.Dispatch<PinAction>;\r\n  state?: PinState;\r\n};\r\n\r\n/** @internal */\r\nexport function pinReducer(state: PinState, action: PinAction): PinState {\r\n  if (action.msg === 'set_pin') {\r\n    return [action.trackReference];\r\n  } else if (action.msg === 'clear_pin') {\r\n    return [];\r\n  } else {\r\n    return { ...state };\r\n  }\r\n}\r\n","import { PIN_DEFAULT_STATE, WIDGET_DEFAULT_STATE } from '@livekit/components-core';\r\nimport * as React from 'react';\r\nimport type { PinContextType } from './pin-context';\r\nimport type { WidgetContextType } from './chat-context';\r\nimport { chatReducer } from './chat-context';\r\nimport { pinReducer } from './pin-context';\r\n\r\n/** @public */\r\nexport type LayoutContextType = {\r\n  pin: PinContextType;\r\n  widget: WidgetContextType;\r\n};\r\n\r\n/** @public */\r\nexport const LayoutContext = React.createContext<LayoutContextType | undefined>(undefined);\r\n\r\n/**\r\n * Ensures that a layout context is provided via context.\r\n * If no layout context is provided, an error is thrown.\r\n * @public\r\n */\r\nexport function useLayoutContext(): LayoutContextType {\r\n  const layoutContext = React.useContext(LayoutContext);\r\n  if (!layoutContext) {\r\n    throw Error('Tried to access LayoutContext context outside a LayoutContextProvider provider.');\r\n  }\r\n  return layoutContext;\r\n}\r\n\r\n/**\r\n * Ensures that a layout context is provided, either via context or explicitly as a parameter.\r\n * If not inside a `LayoutContext` and no layout context is provided, an error is thrown.\r\n * @public\r\n */\r\nexport function useEnsureLayoutContext(layoutContext?: LayoutContextType) {\r\n  const layout = useMaybeLayoutContext();\r\n  layoutContext ??= layout;\r\n  if (!layoutContext) {\r\n    throw Error('Tried to access LayoutContext context outside a LayoutContextProvider provider.');\r\n  }\r\n  return layoutContext;\r\n}\r\n\r\n/** @public */\r\nexport function useCreateLayoutContext(): LayoutContextType {\r\n  const [pinState, pinDispatch] = React.useReducer(pinReducer, PIN_DEFAULT_STATE);\r\n  const [widgetState, widgetDispatch] = React.useReducer(chatReducer, WIDGET_DEFAULT_STATE);\r\n  return {\r\n    pin: { dispatch: pinDispatch, state: pinState },\r\n    widget: { dispatch: widgetDispatch, state: widgetState },\r\n  };\r\n}\r\n\r\n/** @public */\r\nexport function useEnsureCreateLayoutContext(layoutContext?: LayoutContextType): LayoutContextType {\r\n  const [pinState, pinDispatch] = React.useReducer(pinReducer, PIN_DEFAULT_STATE);\r\n  const [widgetState, widgetDispatch] = React.useReducer(chatReducer, WIDGET_DEFAULT_STATE);\r\n  return (\r\n    layoutContext ?? {\r\n      pin: { dispatch: pinDispatch, state: pinState },\r\n      widget: { dispatch: widgetDispatch, state: widgetState },\r\n    }\r\n  );\r\n}\r\n\r\n/**\r\n * Returns a layout context from the `LayoutContext` if it exists, otherwise `undefined`.\r\n * @public\r\n */\r\nexport function useMaybeLayoutContext(): LayoutContextType | undefined {\r\n  return React.useContext(LayoutContext);\r\n}\r\n","import type { TrackReferenceOrPlaceholder } from '@livekit/components-core';\r\nimport * as React from 'react';\r\n\r\n/**\r\n * This context provides a `TrackReferenceOrPlaceholder` to all child components.\r\n * @public\r\n */\r\nexport const TrackRefContext = React.createContext<TrackReferenceOrPlaceholder | undefined>(\r\n  undefined,\r\n);\r\n\r\n/**\r\n * Ensures that a track reference is provided via context.\r\n * If not inside a `TrackRefContext`, an error is thrown.\r\n * @public\r\n */\r\nexport function useTrackRefContext() {\r\n  const trackReference = React.useContext(TrackRefContext);\r\n  if (!trackReference) {\r\n    throw Error('tried to access track context outside of track context provider');\r\n  }\r\n  return trackReference;\r\n}\r\n\r\n/**\r\n * Returns a track reference from the `TrackRefContext` if it exists, otherwise `undefined`.\r\n * @public\r\n */\r\nexport function useMaybeTrackRefContext() {\r\n  return React.useContext(TrackRefContext);\r\n}\r\n\r\n/**\r\n * Ensures that a track reference is provided, either via context or explicitly as a parameter.\r\n * If not inside a `TrackRefContext` and no track reference is provided, an error is thrown.\r\n * @public\r\n */\r\nexport function useEnsureTrackRef(trackRef?: TrackReferenceOrPlaceholder) {\r\n  const context = useMaybeTrackRefContext();\r\n  const ref = trackRef ?? context;\r\n  if (!ref) {\r\n    throw new Error(\r\n      'No TrackRef, make sure you are inside a TrackRefContext or pass the TrackRef explicitly',\r\n    );\r\n  }\r\n  return ref;\r\n}\r\n","import type { Participant } from 'livekit-client';\r\nimport * as React from 'react';\r\nimport { useMaybeTrackRefContext } from './track-reference-context';\r\n\r\n/** @public */\r\nexport const ParticipantContext = React.createContext<Participant | undefined>(undefined);\r\n\r\n/**\r\n * Ensures that a participant is provided via context.\r\n * If not inside a `ParticipantContext`, an error is thrown.\r\n * @public\r\n */\r\nexport function useParticipantContext() {\r\n  const participant = React.useContext(ParticipantContext);\r\n  if (!participant) {\r\n    throw Error('tried to access participant context outside of participant context provider');\r\n  }\r\n  return participant;\r\n}\r\n\r\n/**\r\n * Returns a participant from the `ParticipantContext` if it exists, otherwise `undefined`.\r\n * @public\r\n */\r\nexport function useMaybeParticipantContext() {\r\n  return React.useContext(ParticipantContext);\r\n}\r\n\r\n/**\r\n * Ensures that a participant is provided, either via context or explicitly as a parameter.\r\n * If not inside a `ParticipantContext` and no participant is provided, an error is thrown.\r\n * @public\r\n */\r\nexport function useEnsureParticipant(participant?: Participant) {\r\n  const context = useMaybeParticipantContext();\r\n  const trackContext = useMaybeTrackRefContext();\r\n  const p = participant ?? context ?? trackContext?.participant;\r\n  if (!p) {\r\n    throw new Error(\r\n      'No participant provided, make sure you are inside a participant context or pass the participant explicitly',\r\n    );\r\n  }\r\n  return p;\r\n}\r\n","function r(e){var t,f,n=\"\";if(\"string\"==typeof e||\"number\"==typeof e)n+=e;else if(\"object\"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=\" \"),n+=f)}else for(f in e)e[f]&&(n&&(n+=\" \"),n+=f);return n}export function clsx(){for(var e,t,f=0,n=\"\",o=arguments.length;f<o;f++)(e=arguments[f])&&(t=r(e))&&(n&&(n+=\" \"),n+=t);return n}export default clsx;","/*\r\n * Copyright 2020 Adobe. All rights reserved.\r\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License. You may obtain a copy\r\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software distributed under\r\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\r\n * OF ANY KIND, either express or implied. See the License for the specific language\r\n * governing permissions and limitations under the License.\r\n */\r\n\r\nimport clsx from 'clsx';\r\n\r\n/**\r\n * Calls all functions in the order they were chained with the same arguments.\r\n * @internal\r\n */\r\nexport function chain(...callbacks: any[]): (...args: any[]) => void {\r\n  return (...args: any[]) => {\r\n    for (const callback of callbacks) {\r\n      if (typeof callback === 'function') {\r\n        try {\r\n          callback(...args);\r\n        } catch (e) {\r\n          console.error(e);\r\n        }\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\ninterface Props {\r\n  [key: string]: any;\r\n}\r\n\r\n// taken from: https://stackoverflow.com/questions/51603250/typescript-3-parameter-list-intersection-type/51604379#51604379\r\ntype TupleTypes<T> = { [P in keyof T]: T[P] } extends { [key: number]: infer V } ? V : never;\r\ntype UnionToIntersection<U> = (U extends any ? (k: U) => void : never) extends (k: infer I) => void\r\n  ? I\r\n  : never;\r\n\r\n/**\r\n * Merges multiple props objects together. Event handlers are chained,\r\n * classNames are combined, and ids are deduplicated - different ids\r\n * will trigger a side-effect and re-render components hooked up with `useId`.\r\n * For all other props, the last prop object overrides all previous ones.\r\n * @param args - Multiple sets of props to merge together.\r\n * @internal\r\n */\r\nexport function mergeProps<T extends Props[]>(...args: T): UnionToIntersection<TupleTypes<T>> {\r\n  // Start with a base clone of the first argument. This is a lot faster than starting\r\n  // with an empty object and adding properties as we go.\r\n  const result: Props = { ...args[0] };\r\n  for (let i = 1; i < args.length; i++) {\r\n    const props = args[i];\r\n    for (const key in props) {\r\n      const a = result[key];\r\n      const b = props[key];\r\n\r\n      // Chain events\r\n      if (\r\n        typeof a === 'function' &&\r\n        typeof b === 'function' &&\r\n        // This is a lot faster than a regex.\r\n        key[0] === 'o' &&\r\n        key[1] === 'n' &&\r\n        key.charCodeAt(2) >= /* 'A' */ 65 &&\r\n        key.charCodeAt(2) <= /* 'Z' */ 90\r\n      ) {\r\n        result[key] = chain(a, b);\r\n\r\n        // Merge classnames, sometimes classNames are empty string which eval to false, so we just need to do a type check\r\n      } else if (\r\n        (key === 'className' || key === 'UNSAFE_className') &&\r\n        typeof a === 'string' &&\r\n        typeof b === 'string'\r\n      ) {\r\n        result[key] = clsx(a, b);\r\n      } else {\r\n        result[key] = b !== undefined ? b : a;\r\n      }\r\n    }\r\n  }\r\n\r\n  return result as UnionToIntersection<TupleTypes<T>>;\r\n}\r\n","import { setupConnectionQualityIndicator } from '@livekit/components-core';\r\nimport type { Participant } from 'livekit-client';\r\nimport { ConnectionQuality } from 'livekit-client';\r\nimport * as React from 'react';\r\nimport { useEnsureParticipant } from '../context';\r\nimport { useObservableState } from './internal';\r\n\r\n/** @public */\r\nexport interface ConnectionQualityIndicatorOptions {\r\n  participant?: Participant;\r\n}\r\n\r\n/**\r\n * The `useConnectionQualityIndicator` hook provides props for the `ConnectionQualityIndicator` or your custom implementation of it component.\r\n * @example\r\n * ```tsx\r\n * const { quality } = useConnectionQualityIndicator();\r\n * // or\r\n * const { quality } = useConnectionQualityIndicator({ participant });\r\n * ```\r\n * @public\r\n */\r\nexport function useConnectionQualityIndicator(options: ConnectionQualityIndicatorOptions = {}) {\r\n  const p = useEnsureParticipant(options.participant);\r\n\r\n  const { className, connectionQualityObserver } = React.useMemo(\r\n    () => setupConnectionQualityIndicator(p),\r\n    [p],\r\n  );\r\n\r\n  const quality = useObservableState(connectionQualityObserver, ConnectionQuality.Unknown);\r\n\r\n  return { className, quality };\r\n}\r\n","import { connectionStateObserver } from '@livekit/components-core';\r\nimport type { Room } from 'livekit-client';\r\nimport * as React from 'react';\r\nimport { useEnsureRoom } from '../context';\r\nimport { useObservableState } from './internal';\r\n\r\n/**\r\n * The `useConnectionState` hook allows you to simply implement your own `ConnectionState` component.\r\n *\r\n * @example\r\n * ```tsx\r\n * const connectionState = useConnectionState(room);\r\n * ```\r\n * @public\r\n */\r\nexport function useConnectionState(room?: Room) {\r\n  // passed room takes precedence, if not supplied get current room context\r\n  const r = useEnsureRoom(room);\r\n  const observable = React.useMemo(() => connectionStateObserver(r), [r]);\r\n  const connectionState = useObservableState(observable, r.state);\r\n  return connectionState;\r\n}\r\n","import { setupDisconnectButton } from '@livekit/components-core';\r\nimport { ConnectionState } from 'livekit-client';\r\nimport * as React from 'react';\r\nimport type { DisconnectButtonProps } from '../components';\r\nimport { useRoomContext } from '../context';\r\nimport { mergeProps } from '../mergeProps';\r\nimport { useConnectionState } from './useConnectionStatus';\r\n\r\n/**\r\n * The `useDisconnectButton` hook is used to implement the `DisconnectButton` or your\r\n * custom implementation of it. It adds onClick handler to the button to disconnect\r\n * from the room.\r\n *\r\n * @example\r\n * ```tsx\r\n * const { buttonProps } = useDisconnectButton(buttonProps);\r\n * return <button {...buttonProps}>Disconnect</button>;\r\n * ```\r\n * @public\r\n */\r\nexport function useDisconnectButton(props: DisconnectButtonProps) {\r\n  const room = useRoomContext();\r\n  const connectionState = useConnectionState(room);\r\n\r\n  const buttonProps = React.useMemo(() => {\r\n    const { className, disconnect } = setupDisconnectButton(room);\r\n    const mergedProps = mergeProps(props, {\r\n      className,\r\n      onClick: () => disconnect(props.stopTracks ?? true),\r\n      disabled: connectionState === ConnectionState.Disconnected,\r\n    });\r\n    return mergedProps;\r\n  }, [room, props, connectionState]);\r\n\r\n  return { buttonProps };\r\n}\r\n","import type { TrackReferenceOrPlaceholder } from '@livekit/components-core';\r\nimport { LocalTrackPublication, facingModeFromLocalTrack } from 'livekit-client';\r\n\r\n/**\r\n * Try to determine the `facingMode` of a local participant video track.\r\n * @remarks\r\n * Works only on local video tracks.\r\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints/facingMode | MDN docs on facingMode}\r\n * @alpha\r\n */\r\nexport function useFacingMode(\r\n  trackReference: TrackReferenceOrPlaceholder,\r\n): 'user' | 'environment' | 'left' | 'right' | 'undefined' {\r\n  if (trackReference.publication instanceof LocalTrackPublication) {\r\n    const localTrack = trackReference.publication.track;\r\n    if (localTrack) {\r\n      const { facingMode } = facingModeFromLocalTrack(localTrack);\r\n      return facingMode;\r\n    }\r\n  }\r\n  return 'undefined';\r\n}\r\n","import type { TrackReferenceOrPlaceholder } from '@livekit/components-core';\r\nimport { setupFocusToggle, isTrackReferencePinned } from '@livekit/components-core';\r\nimport { useEnsureTrackRef, useMaybeLayoutContext } from '../context';\r\nimport { mergeProps } from '../mergeProps';\r\nimport * as React from 'react';\r\n\r\n/** @public */\r\nexport interface UseFocusToggleProps {\r\n  trackRef?: TrackReferenceOrPlaceholder;\r\n  props: React.ButtonHTMLAttributes<HTMLButtonElement>;\r\n}\r\n\r\n/**\r\n * The `useFocusToggle` hook is used to implement the `FocusToggle` or your custom implementation of it.\r\n * The `TrackReferenceOrPlaceholder` is used to register a onClick handler and to identify the track to focus on.\r\n *\r\n * @example\r\n * ```tsx\r\n * const { mergedProps, inFocus } = useFocusToggle({ trackRef, props: yourButtonProps });\r\n * return <button {...mergedProps}>{inFocus ? 'Unfocus' : 'Focus'}</button>;\r\n * ```\r\n * @public\r\n */\r\nexport function useFocusToggle({ trackRef, props }: UseFocusToggleProps) {\r\n  const trackReference = useEnsureTrackRef(trackRef);\r\n\r\n  const layoutContext = useMaybeLayoutContext();\r\n  const { className } = React.useMemo(() => setupFocusToggle(), []);\r\n\r\n  const inFocus: boolean = React.useMemo(() => {\r\n    return isTrackReferencePinned(trackReference, layoutContext?.pin.state);\r\n  }, [trackReference, layoutContext?.pin.state]);\r\n\r\n  const mergedProps = React.useMemo(\r\n    () =>\r\n      mergeProps(props, {\r\n        className,\r\n        onClick: (event: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\r\n          // Call user defined on click callbacks.\r\n          props.onClick?.(event);\r\n\r\n          // Set or clear focus based on current focus state.\r\n          if (inFocus) {\r\n            layoutContext?.pin.dispatch?.({\r\n              msg: 'clear_pin',\r\n            });\r\n          } else {\r\n            layoutContext?.pin.dispatch?.({\r\n              msg: 'set_pin',\r\n              trackReference,\r\n            });\r\n          }\r\n        },\r\n      }),\r\n    [props, className, trackReference, inFocus, layoutContext?.pin],\r\n  );\r\n\r\n  return { mergedProps, inFocus };\r\n}\r\n","import { GRID_LAYOUTS, selectGridLayout } from '@livekit/components-core';\r\nimport type { GridLayoutDefinition, GridLayoutInfo } from '@livekit/components-core';\r\nimport * as React from 'react';\r\nimport { useSize } from './internal';\r\n\r\n/**\r\n * The `useGridLayout` hook tries to select the best layout to fit all tiles.\r\n * If the available screen space is not enough, it will reduce the number of maximum visible\r\n * tiles and select a layout that still works visually within the given limitations.\r\n * As the order of tiles changes over time, the hook tries to keep visual updates to a minimum\r\n * while trying to display important tiles such as speaking participants or screen shares.\r\n *\r\n * @example\r\n * ```tsx\r\n * const { layout } = useGridLayout(gridElement, trackCount);\r\n * ```\r\n * @public\r\n */\r\nexport function useGridLayout(\r\n  /** HTML element that contains the grid. */\r\n  gridElement: React.RefObject<HTMLDivElement>,\r\n  /** Count of tracks that should get layed out */\r\n  trackCount: number,\r\n  options: {\r\n    gridLayouts?: GridLayoutDefinition[];\r\n  } = {},\r\n): { layout: GridLayoutInfo; containerWidth: number; containerHeight: number } {\r\n  const gridLayouts = options.gridLayouts ?? GRID_LAYOUTS;\r\n  const { width, height } = useSize(gridElement);\r\n  const layout = selectGridLayout(gridLayouts, trackCount, width, height);\r\n\r\n  React.useEffect(() => {\r\n    if (gridElement.current && layout) {\r\n      gridElement.current.style.setProperty('--lk-col-count', layout?.columns.toString());\r\n      gridElement.current.style.setProperty('--lk-row-count', layout?.rows.toString());\r\n    }\r\n  }, [gridElement, layout]);\r\n\r\n  return {\r\n    layout,\r\n    containerWidth: width,\r\n    containerHeight: height,\r\n  };\r\n}\r\n","import {\r\n  type TrackReferenceOrPlaceholder,\r\n  getTrackReferenceId,\r\n  mutedObserver,\r\n} from '@livekit/components-core';\r\nimport type { Participant, Track } from 'livekit-client';\r\nimport * as React from 'react';\r\nimport { useEnsureParticipant } from '../context';\r\n\r\n/** @public */\r\nexport interface UseIsMutedOptions {\r\n  participant?: Participant;\r\n}\r\n\r\n/**\r\n * The `useIsMuted` hook is used to implement the `TrackMutedIndicator` or your custom implementation of it.\r\n * It returns a `boolean` that indicates if the track is muted or not.\r\n *\r\n * @example With a track reference\r\n * ```tsx\r\n * const isMuted = useIsMuted(track);\r\n * ```\r\n *\r\n * @example With a track source / participant\r\n * ```tsx\r\n * const isMuted = useIsMuted('camera', { participant });\r\n * ```\r\n *\r\n * @param sourceOrTrackRef - Either a `TrackReference` or a `Track.Source` (see usage examples)\r\n * @param options - Additional options when using a `Track.Source`\r\n * @returns boolean indicating if the track is muted\r\n *\r\n * @public\r\n */\r\nexport function useIsMuted(trackRef: TrackReferenceOrPlaceholder): boolean;\r\nexport function useIsMuted(\r\n  sourceOrTrackRef: TrackReferenceOrPlaceholder | Track.Source,\r\n  options: UseIsMutedOptions = {},\r\n) {\r\n  const passedParticipant =\r\n    typeof sourceOrTrackRef === 'string' ? options.participant : sourceOrTrackRef.participant;\r\n  const p = useEnsureParticipant(passedParticipant);\r\n  const ref =\r\n    typeof sourceOrTrackRef === 'string'\r\n      ? { participant: p, source: sourceOrTrackRef }\r\n      : sourceOrTrackRef;\r\n  const [isMuted, setIsMuted] = React.useState(\r\n    !!(ref.publication?.isMuted || p.getTrackPublication(ref.source)?.isMuted),\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    const listener = mutedObserver(ref).subscribe(setIsMuted);\r\n    return () => listener.unsubscribe();\r\n  }, [getTrackReferenceId(ref)]);\r\n\r\n  return isMuted;\r\n}\r\n","import { createIsSpeakingObserver } from '@livekit/components-core';\r\nimport type { Participant } from 'livekit-client';\r\nimport * as React from 'react';\r\nimport { useEnsureParticipant } from '../context';\r\nimport { useObservableState } from './internal';\r\n\r\n/**\r\n * The `useIsSpeaking` hook returns a `boolean` that indicates if the participant is speaking or not.\r\n * @example\r\n * ```tsx\r\n * const isSpeaking = useIsSpeaking(participant);\r\n * ```\r\n * @public\r\n */\r\nexport function useIsSpeaking(participant?: Participant) {\r\n  const p = useEnsureParticipant(participant);\r\n  const observable = React.useMemo(() => createIsSpeakingObserver(p), [p]);\r\n  const isSpeaking = useObservableState(observable, p.isSpeaking);\r\n\r\n  return isSpeaking;\r\n}\r\n","import * as React from 'react';\r\nimport { mergeProps as mergePropsReactAria } from './mergeProps';\r\nimport { log } from '@livekit/components-core';\r\nimport clsx from 'clsx';\r\n\r\n/** @internal */\r\nexport function isProp<U extends HTMLElement, T extends React.HTMLAttributes<U>>(\r\n  prop: T | undefined,\r\n): prop is T {\r\n  return prop !== undefined;\r\n}\r\n\r\n/** @internal */\r\nexport function mergeProps<\r\n  U extends HTMLElement,\r\n  T extends Array<React.HTMLAttributes<U> | undefined>,\r\n>(...props: T) {\r\n  return mergePropsReactAria(...props.filter(isProp));\r\n}\r\n\r\n/** @internal */\r\nexport function cloneSingleChild(\r\n  children: React.ReactNode | React.ReactNode[],\r\n  props?: Record<string, any>,\r\n  key?: any,\r\n) {\r\n  return React.Children.map(children, (child) => {\r\n    // Checking isValidElement is the safe way and avoids a typescript\r\n    // error too.\r\n    if (React.isValidElement(child) && React.Children.only(children)) {\r\n      if (child.props.class) {\r\n        // make sure we retain classnames of both passed props and child\r\n        props ??= {};\r\n        props.class = clsx(child.props.class, props.class);\r\n        props.style = { ...child.props.style, ...props.style };\r\n      }\r\n      return React.cloneElement(child, { ...props, key });\r\n    }\r\n    return child;\r\n  });\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function warnAboutMissingStyles(el?: HTMLElement) {\r\n  if (\r\n    typeof window !== 'undefined' &&\r\n    typeof process !== 'undefined' &&\r\n    // eslint-disable-next-line turbo/no-undeclared-env-vars\r\n    (process?.env?.NODE_ENV === 'dev' ||\r\n      // eslint-disable-next-line turbo/no-undeclared-env-vars\r\n      process?.env?.NODE_ENV === 'development')\r\n  ) {\r\n    const target = el ?? document.querySelector('.lk-room-container');\r\n    if (target && !getComputedStyle(target).getPropertyValue('--lk-has-imported-styles')) {\r\n      log.warn(\r\n        \"It looks like you're not using the `@livekit/components-styles package`. To render the UI with the default styling, please import it in your layout or page.\",\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n *\r\n * @internal\r\n * used to stringify room options to detect dependency changes for react hooks.\r\n * Replaces processors and e2ee options with strings.\r\n */\r\nexport function roomOptionsStringifyReplacer(key: string, val: unknown) {\r\n  if (key === 'processor' && val && typeof val === 'object' && 'name' in val) {\r\n    return val.name;\r\n  }\r\n  if (key === 'e2ee' && val) {\r\n    return 'e2ee-enabled';\r\n  }\r\n  return val;\r\n}\r\n","import { participantPermissionObserver } from '@livekit/components-core';\r\nimport type { ParticipantPermission } from '@livekit/protocol';\r\nimport * as React from 'react';\r\nimport { useRoomContext } from '../context';\r\nimport { useObservableState } from './internal';\r\n\r\n/**\r\n * The `useLocalParticipantPermissions` hook returns the local participant's permissions.\r\n *\r\n * @example\r\n * ```tsx\r\n * const { canPublish, canPublishData } = useLocalParticipantPermissions();\r\n * ```\r\n * @public\r\n */\r\nexport function useLocalParticipantPermissions(): ParticipantPermission | undefined {\r\n  const room = useRoomContext();\r\n  const permissionObserver = React.useMemo(\r\n    () => participantPermissionObserver(room.localParticipant),\r\n    [room],\r\n  );\r\n  const permissions = useObservableState(permissionObserver, room.localParticipant.permissions);\r\n  return permissions;\r\n}\r\n","import { createMediaDeviceObserver, setupDeviceSelector, log } from '@livekit/components-core';\r\nimport { Room, type LocalAudioTrack, type LocalVideoTrack } from 'livekit-client';\r\nimport * as React from 'react';\r\nimport { useMaybeRoomContext } from '../context';\r\nimport { useObservableState } from './internal';\r\n\r\n/** @public */\r\nexport interface UseMediaDeviceSelectProps {\r\n  kind: MediaDeviceKind;\r\n  room?: Room;\r\n  track?: LocalAudioTrack | LocalVideoTrack;\r\n  /**\r\n   * this will call getUserMedia if the permissions are not yet given to enumerate the devices with device labels.\r\n   * in some browsers multiple calls to getUserMedia result in multiple permission prompts.\r\n   * It's generally advised only flip this to true, once a (preview) track has been acquired successfully with the\r\n   * appropriate permissions.\r\n   *\r\n   * @see {@link MediaDeviceMenu}\r\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/enumerateDevices | MDN enumerateDevices}\r\n   */\r\n  requestPermissions?: boolean;\r\n  /**\r\n   * this callback gets called if an error is thrown when failing to select a device and also if a user\r\n   * denied permissions, eventhough the `requestPermissions` option is set to `true`.\r\n   * Most commonly this will emit a MediaDeviceError\r\n   */\r\n  onError?: (e: Error) => void;\r\n}\r\n\r\n/**\r\n * The `useMediaDeviceSelect` hook is used to implement the `MediaDeviceSelect` component and\r\n * returns o.a. the list of devices of a given kind (audioinput or videoinput), the currently active device\r\n * and a function to set the the active device.\r\n *\r\n * @example\r\n * ```tsx\r\n * const { devices, activeDeviceId, setActiveMediaDevice } = useMediaDeviceSelect({kind: 'audioinput'});\r\n * ```\r\n * @public\r\n */\r\nexport function useMediaDeviceSelect({\r\n  kind,\r\n  room,\r\n  track,\r\n  requestPermissions,\r\n  onError,\r\n}: UseMediaDeviceSelectProps) {\r\n  const roomContext = useMaybeRoomContext();\r\n\r\n  const roomFallback = React.useMemo(() => room ?? roomContext ?? new Room(), [room, roomContext]);\r\n\r\n  // List of all devices.\r\n  const deviceObserver = React.useMemo(\r\n    () => createMediaDeviceObserver(kind, onError, requestPermissions),\r\n    [kind, requestPermissions, onError],\r\n  );\r\n  const devices = useObservableState(deviceObserver, [] as MediaDeviceInfo[]);\r\n  // Active device management.\r\n  const [currentDeviceId, setCurrentDeviceId] = React.useState<string>(\r\n    roomFallback?.getActiveDevice(kind) ?? 'default',\r\n  );\r\n  const { className, activeDeviceObservable, setActiveMediaDevice } = React.useMemo(\r\n    () => setupDeviceSelector(kind, roomFallback),\r\n    [kind, roomFallback, track],\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    const listener = activeDeviceObservable.subscribe((deviceId) => {\r\n      if (!deviceId) {\r\n        return;\r\n      }\r\n      log.info('setCurrentDeviceId', deviceId);\r\n      setCurrentDeviceId(deviceId);\r\n    });\r\n    return () => {\r\n      listener?.unsubscribe();\r\n    };\r\n  }, [activeDeviceObservable]);\r\n\r\n  return { devices, className, activeDeviceId: currentDeviceId, setActiveMediaDevice };\r\n}\r\n","import * as React from 'react';\r\nimport { useObservableState } from './internal';\r\nimport { createMediaDeviceObserver } from '@livekit/components-core';\r\n\r\n/**\r\n * The `useMediaDevices` hook returns the list of media devices of a given kind.\r\n *\r\n * @example\r\n * ```tsx\r\n * const videoDevices = useMediaDevices({ kind: 'videoinput' });\r\n * const audioDevices = useMediaDevices({ kind: 'audioinput' });\r\n * ```\r\n * @public\r\n */\r\nexport function useMediaDevices({\r\n  kind,\r\n  onError,\r\n}: {\r\n  kind: MediaDeviceKind;\r\n  onError?: (e: Error) => void;\r\n}) {\r\n  const deviceObserver = React.useMemo(\r\n    () => createMediaDeviceObserver(kind, onError),\r\n    [kind, onError],\r\n  );\r\n  const devices = useObservableState(deviceObserver, [] as MediaDeviceInfo[]);\r\n  return devices;\r\n}\r\n","import type { TrackReferenceOrPlaceholder } from '@livekit/components-core';\r\nimport { log, sortTrackReferences, updatePages } from '@livekit/components-core';\r\nimport * as React from 'react';\r\n\r\n/** @public */\r\nexport interface UseVisualStableUpdateOptions {\r\n  /** Overwrites the default sort function. */\r\n  customSortFunction?: (\r\n    trackReferences: TrackReferenceOrPlaceholder[],\r\n  ) => TrackReferenceOrPlaceholder[];\r\n}\r\n\r\n/**\r\n * The `useVisualStableUpdate` hook is used to prevent visually jarring jumps and shifts of elements\r\n * in an array. The algorithm only starts to update when there are more items than visually fit\r\n * on a page. If this is the case, it will make sure that speaking participants move to the first\r\n * page and are always visible.\r\n * @remarks\r\n * Updating the array can occur because attendees leave or join a room, or because they mute/unmute\r\n * or start speaking.\r\n * The hook is used for the `GridLayout` and `CarouselLayout` components.\r\n *\r\n * @example\r\n * ```tsx\r\n * const trackRefs = useTracks();\r\n * const updatedTrackRefs = useVisualStableUpdate(trackRefs, itemPerPage);\r\n * ```\r\n * @public\r\n */\r\nexport function useVisualStableUpdate(\r\n  /** `TrackReference`s to display in the grid.  */\r\n  trackReferences: TrackReferenceOrPlaceholder[],\r\n  maxItemsOnPage: number,\r\n  options: UseVisualStableUpdateOptions = {},\r\n): TrackReferenceOrPlaceholder[] {\r\n  const lastTrackRefs = React.useRef<TrackReferenceOrPlaceholder[]>([]);\r\n  const lastMaxItemsOnPage = React.useRef<number>(-1);\r\n  const layoutChanged = maxItemsOnPage !== lastMaxItemsOnPage.current;\r\n\r\n  const sortedTrackRefs =\r\n    typeof options.customSortFunction === 'function'\r\n      ? options.customSortFunction(trackReferences)\r\n      : sortTrackReferences(trackReferences);\r\n\r\n  let updatedTrackRefs: TrackReferenceOrPlaceholder[] = [...sortedTrackRefs];\r\n  if (layoutChanged === false) {\r\n    try {\r\n      updatedTrackRefs = updatePages(lastTrackRefs.current, sortedTrackRefs, maxItemsOnPage);\r\n    } catch (error) {\r\n      log.error('Error while running updatePages(): ', error);\r\n    }\r\n  }\r\n\r\n  // Save info for to compare against in the next update cycle.\r\n  if (layoutChanged) {\r\n    lastTrackRefs.current = sortedTrackRefs;\r\n  } else {\r\n    lastTrackRefs.current = updatedTrackRefs;\r\n  }\r\n  lastMaxItemsOnPage.current = maxItemsOnPage;\r\n\r\n  return updatedTrackRefs;\r\n}\r\n","import type { TrackReferenceOrPlaceholder } from '@livekit/components-core';\r\nimport * as React from 'react';\r\nimport { useVisualStableUpdate } from './useVisualStableUpdate';\r\n\r\n/**\r\n * The `usePagination` hook implements simple pagination logic for use with arrays.\r\n * @example\r\n * ```tsx\r\n * const tracks = useTracks();\r\n * const pagination = usePagination(4, tracks);\r\n *\r\n * <TrackLoop tracks={pagination.tracks} />\r\n * ```\r\n * @alpha\r\n */\r\nexport function usePagination(itemPerPage: number, trackReferences: TrackReferenceOrPlaceholder[]) {\r\n  const [currentPage, setCurrentPage] = React.useState(1);\r\n  const totalPageCount = Math.max(Math.ceil(trackReferences.length / itemPerPage), 1);\r\n  if (currentPage > totalPageCount) {\r\n    setCurrentPage(totalPageCount);\r\n  }\r\n  const lastItemIndex = currentPage * itemPerPage;\r\n  const firstItemIndex = lastItemIndex - itemPerPage;\r\n\r\n  const changePage = (direction: 'next' | 'previous') => {\r\n    setCurrentPage((state) => {\r\n      if (direction === 'next') {\r\n        if (state === totalPageCount) {\r\n          return state;\r\n        }\r\n        return state + 1;\r\n      } else {\r\n        if (state === 1) {\r\n          return state;\r\n        }\r\n        return state - 1;\r\n      }\r\n    });\r\n  };\r\n\r\n  const goToPage = (num: number) => {\r\n    if (num > totalPageCount) {\r\n      setCurrentPage(totalPageCount);\r\n    } else if (num < 1) {\r\n      setCurrentPage(1);\r\n    } else {\r\n      setCurrentPage(num);\r\n    }\r\n  };\r\n\r\n  const updatedTrackReferences = useVisualStableUpdate(trackReferences, itemPerPage);\r\n\r\n  const tracksOnPage = updatedTrackReferences.slice(firstItemIndex, lastItemIndex);\r\n\r\n  return {\r\n    totalPageCount,\r\n    nextPage: () => changePage('next'),\r\n    prevPage: () => changePage('previous'),\r\n    setPage: goToPage,\r\n    firstItemIndex,\r\n    lastItemIndex,\r\n    tracks: tracksOnPage,\r\n    currentPage,\r\n  };\r\n}\r\n\r\nexport default usePagination;\r\n","import type { ParticipantClickEvent, TrackReferenceOrPlaceholder } from '@livekit/components-core';\r\nimport { setupParticipantTile } from '@livekit/components-core';\r\nimport * as React from 'react';\r\nimport { useEnsureTrackRef } from '../context';\r\nimport { mergeProps } from '../mergeProps';\r\nimport { useFacingMode } from './useFacingMode';\r\nimport { useIsMuted } from './useIsMuted';\r\nimport { useIsSpeaking } from './useIsSpeaking';\r\nimport { Track } from 'livekit-client';\r\n\r\n/** @public */\r\nexport interface UseParticipantTileProps<T extends HTMLElement> extends React.HTMLAttributes<T> {\r\n  /** The track reference to display. */\r\n  trackRef?: TrackReferenceOrPlaceholder;\r\n  disableSpeakingIndicator?: boolean;\r\n  onParticipantClick?: (event: ParticipantClickEvent) => void;\r\n  htmlProps: React.HTMLAttributes<T>;\r\n}\r\n\r\n/**\r\n * The `useParticipantTile` hook is used to implement the `ParticipantTile` and returns the props needed to render the tile.\r\n * @remarks\r\n * The returned props include many data attributes that are useful for CSS styling purposes because they\r\n * indicate the state of the participant and the track.\r\n * For example: `data-lk-audio-muted`, `data-lk-video-muted`, `data-lk-speaking`, `data-lk-local-participant`, `data-lk-source`, `data-lk-facing-mode`.\r\n * @public\r\n */\r\nexport function useParticipantTile<T extends HTMLElement>({\r\n  trackRef,\r\n  onParticipantClick,\r\n  disableSpeakingIndicator,\r\n  htmlProps,\r\n}: UseParticipantTileProps<T>) {\r\n  const trackReference = useEnsureTrackRef(trackRef);\r\n\r\n  const mergedProps = React.useMemo(() => {\r\n    const { className } = setupParticipantTile();\r\n    return mergeProps(htmlProps, {\r\n      className,\r\n      onClick: (event: React.MouseEvent<T, MouseEvent>) => {\r\n        htmlProps.onClick?.(event);\r\n        if (typeof onParticipantClick === 'function') {\r\n          const track =\r\n            trackReference.publication ??\r\n            trackReference.participant.getTrackPublication(trackReference.source);\r\n          onParticipantClick({ participant: trackReference.participant, track });\r\n        }\r\n      },\r\n    });\r\n  }, [\r\n    htmlProps,\r\n    onParticipantClick,\r\n    trackReference.publication,\r\n    trackReference.source,\r\n    trackReference.participant,\r\n  ]);\r\n\r\n  const micTrack = trackReference.participant.getTrackPublication(Track.Source.Microphone);\r\n  const micRef = React.useMemo(() => {\r\n    return {\r\n      participant: trackReference.participant,\r\n      source: Track.Source.Microphone,\r\n      publication: micTrack,\r\n    };\r\n  }, [micTrack, trackReference.participant]);\r\n  const isVideoMuted = useIsMuted(trackReference);\r\n  const isAudioMuted = useIsMuted(micRef);\r\n  const isSpeaking = useIsSpeaking(trackReference.participant);\r\n  const facingMode = useFacingMode(trackReference);\r\n  return {\r\n    elementProps: {\r\n      'data-lk-audio-muted': isAudioMuted,\r\n      'data-lk-video-muted': isVideoMuted,\r\n      'data-lk-speaking': disableSpeakingIndicator === true ? false : isSpeaking,\r\n      'data-lk-local-participant': trackReference.participant.isLocal,\r\n      'data-lk-source': trackReference.source,\r\n      'data-lk-facing-mode': facingMode,\r\n      ...mergedProps,\r\n    } as React.HTMLAttributes<T>,\r\n  };\r\n}\r\n","import type { TrackReferenceOrPlaceholder } from '@livekit/components-core';\r\nimport * as React from 'react';\r\nimport type { LayoutContextType } from '../context';\r\nimport { useEnsureLayoutContext } from '../context';\r\n\r\n/**\r\n * The `usePinnedTracks` hook returns a array of the pinned tracks of the current room.\r\n * @remarks\r\n * To function properly, this hook must be called within a `LayoutContext`.\r\n * @example\r\n * ```tsx\r\n * const pinnedTracks = usePinnedTracks();\r\n * ```\r\n * @public\r\n */\r\nexport function usePinnedTracks(layoutContext?: LayoutContextType): TrackReferenceOrPlaceholder[] {\r\n  layoutContext = useEnsureLayoutContext(layoutContext);\r\n  return React.useMemo(() => {\r\n    if (layoutContext?.pin.state !== undefined && layoutContext.pin.state.length >= 1) {\r\n      return layoutContext.pin.state;\r\n    }\r\n    return [];\r\n  }, [layoutContext.pin.state]);\r\n}\r\n","import { setupStartAudio } from '@livekit/components-core';\r\nimport type { Room } from 'livekit-client';\r\nimport * as React from 'react';\r\nimport { useEnsureRoom } from '../context';\r\nimport { mergeProps } from '../mergeProps';\r\nimport { useObservableState } from './internal';\r\n\r\n/** @alpha */\r\nexport interface UseStartAudioProps {\r\n  room?: Room;\r\n  props: React.ButtonHTMLAttributes<HTMLButtonElement>;\r\n}\r\n\r\n/**\r\n * In many browsers to start audio playback, the user must perform a user-initiated event such as clicking a button.\r\n * The `useStatAudio` hook returns an object with a boolean `canPlayAudio` flag\r\n * that indicates whether audio playback is allowed in the current context,\r\n * as well as a `startAudio` function that can be called in a button `onClick` callback to start audio playback in the current context.\r\n *\r\n * @see Autoplay policy on MDN web docs for more info: {@link https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Best_practices#autoplay_policy}\r\n * @alpha\r\n */\r\nexport function useStartAudio({ room, props }: UseStartAudioProps) {\r\n  const roomEnsured = useEnsureRoom(room);\r\n  const { className, roomAudioPlaybackAllowedObservable, handleStartAudioPlayback } = React.useMemo(\r\n    () => setupStartAudio(),\r\n    [],\r\n  );\r\n  const observable = React.useMemo(\r\n    () => roomAudioPlaybackAllowedObservable(roomEnsured),\r\n    [roomEnsured, roomAudioPlaybackAllowedObservable],\r\n  );\r\n  const { canPlayAudio } = useObservableState(observable, {\r\n    canPlayAudio: roomEnsured.canPlaybackAudio,\r\n  });\r\n\r\n  const mergedProps = React.useMemo(\r\n    () =>\r\n      mergeProps(props, {\r\n        className,\r\n        onClick: () => {\r\n          handleStartAudioPlayback(roomEnsured);\r\n        },\r\n        style: { display: canPlayAudio ? 'none' : 'block' },\r\n      }),\r\n    [props, className, canPlayAudio, handleStartAudioPlayback, roomEnsured],\r\n  );\r\n\r\n  return { mergedProps, canPlayAudio };\r\n}\r\n","import { setupStartVideo } from '@livekit/components-core';\r\nimport type { Room } from 'livekit-client';\r\nimport * as React from 'react';\r\nimport { useEnsureRoom } from '../context';\r\nimport { mergeProps } from '../mergeProps';\r\nimport { useObservableState } from './internal';\r\n\r\n/** @alpha */\r\nexport interface UseStartVideoProps {\r\n  room?: Room;\r\n  props: React.ButtonHTMLAttributes<HTMLButtonElement>;\r\n}\r\n\r\n/**\r\n * In some browsers to start video playback in low power mode, the user must perform a user-initiated event such as clicking a button.\r\n * The `useStartVideo` hook returns an object with a boolean `canPlayVideo` flag\r\n * that indicates whether video playback is allowed in the current context,\r\n * as well as a `startVideo` function that can be called in a button `onClick` callback to start video playback in the current context.\r\n *\r\n * @alpha\r\n */\r\nexport function useStartVideo({ room, props }: UseStartVideoProps) {\r\n  const roomEnsured = useEnsureRoom(room);\r\n  const { className, roomVideoPlaybackAllowedObservable, handleStartVideoPlayback } = React.useMemo(\r\n    () => setupStartVideo(),\r\n    [],\r\n  );\r\n  const observable = React.useMemo(\r\n    () => roomVideoPlaybackAllowedObservable(roomEnsured),\r\n    [roomEnsured, roomVideoPlaybackAllowedObservable],\r\n  );\r\n  const { canPlayVideo } = useObservableState(observable, {\r\n    canPlayVideo: roomEnsured.canPlaybackVideo,\r\n  });\r\n\r\n  const mergedProps = React.useMemo(\r\n    () =>\r\n      mergeProps(props, {\r\n        className,\r\n        onClick: () => {\r\n          handleStartVideoPlayback(roomEnsured);\r\n        },\r\n        style: { display: canPlayVideo ? 'none' : 'block' },\r\n      }),\r\n    [props, className, canPlayVideo, handleStartVideoPlayback, roomEnsured],\r\n  );\r\n\r\n  return { mergedProps, canPlayVideo };\r\n}\r\n","import * as React from 'react';\r\n\r\n/**\r\n * @alpha\r\n */\r\nexport type UseSwipeOptions = {\r\n  minSwipeDistance?: number;\r\n  onLeftSwipe?: () => void;\r\n  onRightSwipe?: () => void;\r\n};\r\n\r\n/**\r\n * Simple implementation to detect horizontal swipe actions.\r\n * Accepts callbacks for on right and left swipes.\r\n * @example\r\n * ```tsx\r\n *  <div\r\n      onTouchStart={onTouchStart}\r\n      onTouchMove={onTouchMove}\r\n      onTouchEnd={onTouchEnd}\r\n    >\r\n * ```\r\n * @alpha\r\n */\r\nexport function useSwipe(element: React.RefObject<HTMLElement>, options: UseSwipeOptions = {}) {\r\n  const touchStart = React.useRef<number | null>(null);\r\n  const touchEnd = React.useRef<number | null>(null);\r\n\r\n  // The required distance between touchStart and touchEnd to be detected as a swipe.\r\n  const minSwipeDistance = options.minSwipeDistance ?? 50;\r\n\r\n  const onTouchStart = (event: TouchEvent) => {\r\n    touchEnd.current = null; // Otherwise the swipe is fired even with usual touch events.\r\n    touchStart.current = event.targetTouches[0].clientX;\r\n  };\r\n\r\n  const onTouchMove = (event: TouchEvent) => {\r\n    touchEnd.current = event.targetTouches[0].clientX;\r\n  };\r\n\r\n  const onTouchEnd = React.useCallback(() => {\r\n    if (!touchStart.current || !touchEnd.current) {\r\n      return;\r\n    }\r\n    const distance = touchStart.current - touchEnd.current;\r\n    const isLeftSwipe = distance > minSwipeDistance;\r\n    const isRightSwipe = distance < -minSwipeDistance;\r\n\r\n    if (isLeftSwipe && options.onLeftSwipe) options.onLeftSwipe();\r\n    if (isRightSwipe && options.onRightSwipe) options.onRightSwipe();\r\n  }, [minSwipeDistance, options]);\r\n\r\n  React.useEffect(() => {\r\n    const elementCopy = element.current;\r\n    if (elementCopy) {\r\n      elementCopy.addEventListener('touchstart', onTouchStart, { passive: true });\r\n      elementCopy.addEventListener('touchmove', onTouchMove, { passive: true });\r\n      elementCopy.addEventListener('touchend', onTouchEnd, { passive: true });\r\n    }\r\n    return () => {\r\n      if (elementCopy) {\r\n        elementCopy.removeEventListener('touchstart', onTouchStart);\r\n        elementCopy.removeEventListener('touchmove', onTouchMove);\r\n        elementCopy.removeEventListener('touchend', onTouchEnd);\r\n      }\r\n    };\r\n  }, [element, onTouchEnd]);\r\n}\r\n","import { setupChatToggle } from '@livekit/components-core';\r\nimport { useLayoutContext } from '../context';\r\nimport { mergeProps } from '../mergeProps';\r\nimport * as React from 'react';\r\n\r\n/** @public */\r\nexport interface UseChatToggleProps {\r\n  props: React.ButtonHTMLAttributes<HTMLButtonElement>;\r\n}\r\n\r\n/**\r\n * The `useChatToggle` hook provides state and functions for toggling the chat window.\r\n * @remarks\r\n * Depends on the `LayoutContext` to work properly.\r\n * @see {@link ChatToggle}, {@link Chat}\r\n * @public\r\n */\r\nexport function useChatToggle({ props }: UseChatToggleProps) {\r\n  const { dispatch, state } = useLayoutContext().widget;\r\n  const { className } = React.useMemo(() => setupChatToggle(), []);\r\n\r\n  const mergedProps = React.useMemo(() => {\r\n    return mergeProps(props, {\r\n      className,\r\n      onClick: () => {\r\n        if (dispatch) dispatch({ msg: 'toggle_chat' });\r\n      },\r\n      'aria-pressed': state?.showChat ? 'true' : 'false',\r\n      'data-lk-unread-msgs': state\r\n        ? state.unreadMessages < 10\r\n          ? state.unreadMessages.toFixed(0)\r\n          : '9+'\r\n        : '0',\r\n    });\r\n  }, [props, className, dispatch, state]);\r\n\r\n  return { mergedProps };\r\n}\r\n","import {\r\n  type TrackReferenceOrPlaceholder,\r\n  setupTrackMutedIndicator,\r\n  getTrackReferenceId,\r\n} from '@livekit/components-core';\r\nimport * as React from 'react';\r\nimport { useEnsureTrackRef } from '../context';\r\nimport { useObservableState } from './internal';\r\n\r\ninterface TrackMutedIndicatorReturnType {\r\n  isMuted: boolean;\r\n  className: string;\r\n}\r\n\r\n/**\r\n * The `useTrackMutedIndicator` hook is used to implement the `TrackMutedIndicator` component\r\n * and returns the muted state of the given track.\r\n *\r\n * @example\r\n * ```tsx\r\n * const { isMuted } = useTrackMutedIndicator(trackRef);\r\n * ```\r\n * @public\r\n */\r\nexport function useTrackMutedIndicator(\r\n  trackRef?: TrackReferenceOrPlaceholder,\r\n): TrackMutedIndicatorReturnType {\r\n  const trackReference = useEnsureTrackRef(trackRef);\r\n\r\n  const { className, mediaMutedObserver } = React.useMemo(\r\n    () => setupTrackMutedIndicator(trackReference),\r\n    [getTrackReferenceId(trackReference)],\r\n  );\r\n\r\n  const isMuted = useObservableState(\r\n    mediaMutedObserver,\r\n    !!(\r\n      trackReference.publication?.isMuted ||\r\n      trackReference.participant.getTrackPublication(trackReference.source)?.isMuted\r\n    ),\r\n  );\r\n\r\n  return { isMuted, className };\r\n}\r\n","import type { ToggleSource } from '@livekit/components-core';\r\nimport { setupMediaToggle, setupManualToggle, log } from '@livekit/components-core';\r\nimport * as React from 'react';\r\nimport type { TrackToggleProps } from '../components';\r\nimport { useMaybeRoomContext } from '../context';\r\nimport { mergeProps } from '../mergeProps';\r\nimport { useObservableState } from './internal';\r\n\r\n/** @public */\r\nexport interface UseTrackToggleProps<T extends ToggleSource>\r\n  extends Omit<TrackToggleProps<T>, 'showIcon'> {}\r\n\r\n/**\r\n * The `useTrackToggle` hook is used to implement the `TrackToggle` component and returns state\r\n * and functionality of the given track.\r\n *\r\n * @example\r\n * ```tsx\r\n * const { buttonProps, enabled } = useTrackToggle(trackRef);\r\n * return <button {...buttonProps}>{enabled ? 'disable' : 'enable'}</button>;\r\n * ```\r\n * @public\r\n */\r\nexport function useTrackToggle<T extends ToggleSource>({\r\n  source,\r\n  onChange,\r\n  initialState,\r\n  captureOptions,\r\n  publishOptions,\r\n  onDeviceError,\r\n  ...rest\r\n}: UseTrackToggleProps<T>) {\r\n  const room = useMaybeRoomContext();\r\n  const track = room?.localParticipant?.getTrackPublication(source);\r\n  /** `true` if a user interaction such as a click on the TrackToggle button has occurred. */\r\n  const userInteractionRef = React.useRef(false);\r\n\r\n  const { toggle, className, pendingObserver, enabledObserver } = React.useMemo(\r\n    () =>\r\n      room\r\n        ? setupMediaToggle<T>(source, room, captureOptions, publishOptions, onDeviceError)\r\n        : setupManualToggle(),\r\n    [room, source, JSON.stringify(captureOptions), publishOptions],\r\n  );\r\n\r\n  const pending = useObservableState(pendingObserver, false);\r\n  const enabled = useObservableState(enabledObserver, initialState ?? !!track?.isEnabled);\r\n\r\n  React.useEffect(() => {\r\n    onChange?.(enabled, userInteractionRef.current);\r\n    userInteractionRef.current = false;\r\n  }, [enabled, onChange]);\r\n\r\n  React.useEffect(() => {\r\n    if (initialState !== undefined) {\r\n      log.debug('forcing initial toggle state', source, initialState);\r\n      toggle(initialState);\r\n    }\r\n    // only execute once at the beginning\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const newProps = React.useMemo(() => mergeProps(rest, { className }), [rest, className]);\r\n\r\n  const clickHandler: React.MouseEventHandler<HTMLButtonElement> = React.useCallback(\r\n    (evt) => {\r\n      userInteractionRef.current = true;\r\n      toggle().catch(() => (userInteractionRef.current = false));\r\n      rest.onClick?.(evt);\r\n    },\r\n    [rest, toggle],\r\n  );\r\n\r\n  return {\r\n    toggle,\r\n    enabled,\r\n    pending,\r\n    track,\r\n    buttonProps: {\r\n      ...newProps,\r\n      'aria-pressed': enabled,\r\n      'data-lk-source': source,\r\n      'data-lk-enabled': enabled,\r\n      disabled: pending,\r\n      onClick: clickHandler,\r\n    } as React.ButtonHTMLAttributes<HTMLButtonElement>,\r\n  };\r\n}\r\n","import type {\r\n  SourcesArray,\r\n  TrackReference,\r\n  TrackReferenceOrPlaceholder,\r\n  TrackSourceWithOptions,\r\n  TrackReferencePlaceholder,\r\n} from '@livekit/components-core';\r\nimport {\r\n  isSourcesWithOptions,\r\n  isSourceWitOptions,\r\n  log,\r\n  trackReferencesObservable,\r\n} from '@livekit/components-core';\r\nimport type { Participant, Room, RoomEvent } from 'livekit-client';\r\nimport { Track } from 'livekit-client';\r\nimport * as React from 'react';\r\nimport { useEnsureRoom } from '../context';\r\n\r\n/** @public */\r\nexport type UseTracksOptions = {\r\n  updateOnlyOn?: RoomEvent[];\r\n  onlySubscribed?: boolean;\r\n  room?: Room;\r\n};\r\n\r\n/** @public */\r\nexport type UseTracksHookReturnType<T> = T extends Track.Source[]\r\n  ? TrackReference[]\r\n  : T extends TrackSourceWithOptions[]\r\n    ? TrackReferenceOrPlaceholder[]\r\n    : never;\r\n\r\n/**\r\n * The `useTracks` hook returns an array of `TrackReference` or `TrackReferenceOrPlaceholder` depending on the provided `sources` property.\r\n * If only subscribed tracks are desired, set the `onlySubscribed` property to `true`.\r\n * @example\r\n * ```ts\r\n * // Return all camera track publications.\r\n * const trackReferences: TrackReference[] = useTracks([Track.Source.Camera])\r\n * ```\r\n * @example\r\n * ```ts\r\n * // Return all subscribed camera tracks as well as placeholders for\r\n * // participants without a camera subscription.\r\n * const trackReferencesWithPlaceholders: TrackReferenceOrPlaceholder[] = useTracks([{source: Track.Source.Camera, withPlaceholder: true}])\r\n * ```\r\n * @public\r\n */\r\nexport function useTracks<T extends SourcesArray = Track.Source[]>(\r\n  sources: T = [\r\n    Track.Source.Camera,\r\n    Track.Source.Microphone,\r\n    Track.Source.ScreenShare,\r\n    Track.Source.ScreenShareAudio,\r\n    Track.Source.Unknown,\r\n  ] as T,\r\n  options: UseTracksOptions = {},\r\n): UseTracksHookReturnType<T> {\r\n  const room = useEnsureRoom(options.room);\r\n  const [trackReferences, setTrackReferences] = React.useState<TrackReference[]>([]);\r\n  const [participants, setParticipants] = React.useState<Participant[]>([]);\r\n\r\n  const sources_ = React.useMemo(() => {\r\n    return sources.map((s) => (isSourceWitOptions(s) ? s.source : s));\r\n  }, [JSON.stringify(sources)]);\r\n\r\n  React.useEffect(() => {\r\n    const subscription = trackReferencesObservable(room, sources_, {\r\n      additionalRoomEvents: options.updateOnlyOn,\r\n      onlySubscribed: options.onlySubscribed,\r\n    }).subscribe(({ trackReferences, participants }) => {\r\n      log.debug('setting track bundles', trackReferences, participants);\r\n      setTrackReferences(trackReferences);\r\n      setParticipants(participants);\r\n    });\r\n    return () => subscription.unsubscribe();\r\n  }, [\r\n    room,\r\n    JSON.stringify(options.onlySubscribed),\r\n    JSON.stringify(options.updateOnlyOn),\r\n    JSON.stringify(sources),\r\n  ]);\r\n\r\n  const maybeTrackReferences = React.useMemo(() => {\r\n    if (isSourcesWithOptions(sources)) {\r\n      const requirePlaceholder = requiredPlaceholders(sources, participants);\r\n      const trackReferencesWithPlaceholders: TrackReferenceOrPlaceholder[] =\r\n        Array.from(trackReferences);\r\n      participants.forEach((participant) => {\r\n        if (requirePlaceholder.has(participant.identity)) {\r\n          const sourcesToAddPlaceholder = requirePlaceholder.get(participant.identity) ?? [];\r\n          sourcesToAddPlaceholder.forEach((placeholderSource) => {\r\n            if (\r\n              trackReferences.find(\r\n                ({ participant: p, publication }) =>\r\n                  participant.identity === p.identity && publication.source === placeholderSource,\r\n              )\r\n            ) {\r\n              return;\r\n            }\r\n            log.debug(\r\n              `Add ${placeholderSource} placeholder for participant ${participant.identity}.`,\r\n            );\r\n            const placeholder: TrackReferencePlaceholder = {\r\n              participant,\r\n              source: placeholderSource,\r\n            };\r\n            trackReferencesWithPlaceholders.push(placeholder);\r\n          });\r\n        }\r\n      });\r\n      return trackReferencesWithPlaceholders;\r\n    } else {\r\n      return trackReferences;\r\n    }\r\n  }, [trackReferences, participants, sources]);\r\n\r\n  return maybeTrackReferences as UseTracksHookReturnType<T>;\r\n}\r\n\r\nfunction difference<T>(setA: Set<T>, setB: Set<T>): Set<T> {\r\n  const _difference = new Set(setA);\r\n  for (const elem of setB) {\r\n    _difference.delete(elem);\r\n  }\r\n  return _difference;\r\n}\r\n\r\nexport function requiredPlaceholders<T extends SourcesArray>(\r\n  sources: T,\r\n  participants: Participant[],\r\n): Map<Participant['identity'], Track.Source[]> {\r\n  const placeholderMap = new Map<Participant['identity'], Track.Source[]>();\r\n  if (isSourcesWithOptions(sources)) {\r\n    const sourcesThatNeedPlaceholder = sources\r\n      .filter((sourceWithOption) => sourceWithOption.withPlaceholder)\r\n      .map((sourceWithOption) => sourceWithOption.source);\r\n\r\n    participants.forEach((participant) => {\r\n      const sourcesOfSubscribedTracks = participant\r\n        .getTrackPublications()\r\n        .map((pub) => pub.track?.source)\r\n        .filter((trackSource): trackSource is Track.Source => trackSource !== undefined);\r\n      const placeholderNeededForThisParticipant = Array.from(\r\n        difference(new Set(sourcesThatNeedPlaceholder), new Set(sourcesOfSubscribedTracks)),\r\n      );\r\n      // If the participant needs placeholder add it to the placeholder map.\r\n      if (placeholderNeededForThisParticipant.length > 0) {\r\n        placeholderMap.set(participant.identity, placeholderNeededForThisParticipant);\r\n      }\r\n    });\r\n  }\r\n  return placeholderMap;\r\n}\r\n","import * as React from 'react';\r\nimport type { ChatOptions, ReceivedChatMessage } from '@livekit/components-core';\r\nimport { setupChat } from '@livekit/components-core';\r\nimport { ConnectionState } from 'livekit-client';\r\nimport { useRoomContext } from '../context';\r\nimport { useObservableState } from './internal/useObservableState';\r\nimport { useConnectionState } from './useConnectionStatus';\r\n\r\n/**\r\n * The `useChat` hook provides chat functionality for a LiveKit room.\r\n *\r\n * @remarks\r\n * Message history is not persisted and will be lost if the component is refreshed.\r\n * You may want to persist message history in the browser, a cache or a database.\r\n *\r\n * @returns An object containing:\r\n * - `chatMessages` - Array of received chat messages\r\n * - `send` - Function to send a new message\r\n * - `isSending` - Boolean indicating if a message is currently being sent\r\n *\r\n * @example\r\n * ```tsx\r\n * function ChatComponent() {\r\n *   const { chatMessages, send, isSending } = useChat();\r\n *\r\n *   return (\r\n *     <div>\r\n *       {chatMessages.map((msg) => (\r\n *         <div key={msg.timestamp}>\r\n *           {msg.from?.identity}: {msg.message}\r\n *         </div>\r\n *       ))}\r\n *       <button disabled={isSending} onClick={() => send(\"Hello!\")}>\r\n *         Send Message\r\n *       </button>\r\n *     </div>\r\n *   );\r\n * }\r\n * ```\r\n * @public\r\n */\r\nexport function useChat(options?: ChatOptions) {\r\n  const room = useRoomContext();\r\n  const connectionState = useConnectionState(room);\r\n  const isDisconnected = React.useMemo(\r\n    () => connectionState === ConnectionState.Disconnected,\r\n    [connectionState],\r\n  ); // used to reset the messages on room disconnect\r\n  const setup = React.useMemo<ReturnType<typeof setupChat>>(\r\n    () => setupChat(room, options),\r\n    [room, options, isDisconnected],\r\n  );\r\n  const isSending = useObservableState(setup.isSendingObservable, false);\r\n  const chatMessages = useObservableState<ReceivedChatMessage[]>(setup.messageObservable, []);\r\n\r\n  return { send: setup.send, update: setup.update, chatMessages, isSending };\r\n}\r\n","import type { LocalUserChoices } from '@livekit/components-core';\r\nimport { loadUserChoices, saveUserChoices } from '@livekit/components-core';\r\nimport * as React from 'react';\r\n\r\n/**\r\n * Options for the `usePersistentDeviceSettings` hook.\r\n * @alpha\r\n */\r\nexport interface UsePersistentUserChoicesOptions {\r\n  /**\r\n   * The default value to use if reading from local storage returns no results or fails.\r\n   */\r\n  defaults?: Partial<LocalUserChoices>;\r\n  /**\r\n   * Whether to prevent saving to persistent storage.\r\n   * @defaultValue false\r\n   */\r\n  preventSave?: boolean;\r\n  /**\r\n   * Whether to prevent loading user choices from persistent storage and use `defaults` instead.\r\n   * @defaultValue false\r\n   */\r\n  preventLoad?: boolean;\r\n}\r\n\r\n/**\r\n * A hook that provides access to user choices stored in local storage, such as\r\n * selected media devices and their current state (on or off), as well as the user name.\r\n * @alpha\r\n */\r\nexport function usePersistentUserChoices(options: UsePersistentUserChoicesOptions = {}) {\r\n  const [userChoices, setSettings] = React.useState<LocalUserChoices>(\r\n    loadUserChoices(options.defaults, options.preventLoad ?? false),\r\n  );\r\n\r\n  const saveAudioInputEnabled = React.useCallback((isEnabled: boolean) => {\r\n    setSettings((prev) => ({ ...prev, audioEnabled: isEnabled }));\r\n  }, []);\r\n  const saveVideoInputEnabled = React.useCallback((isEnabled: boolean) => {\r\n    setSettings((prev) => ({ ...prev, videoEnabled: isEnabled }));\r\n  }, []);\r\n  const saveAudioInputDeviceId = React.useCallback((deviceId: string) => {\r\n    setSettings((prev) => ({ ...prev, audioDeviceId: deviceId }));\r\n  }, []);\r\n  const saveVideoInputDeviceId = React.useCallback((deviceId: string) => {\r\n    setSettings((prev) => ({ ...prev, videoDeviceId: deviceId }));\r\n  }, []);\r\n  const saveUsername = React.useCallback((username: string) => {\r\n    setSettings((prev) => ({ ...prev, username: username }));\r\n  }, []);\r\n\r\n  React.useEffect(() => {\r\n    saveUserChoices(userChoices, options.preventSave ?? false);\r\n  }, [userChoices, options.preventSave]);\r\n\r\n  return {\r\n    userChoices,\r\n    saveAudioInputEnabled,\r\n    saveVideoInputEnabled,\r\n    saveAudioInputDeviceId,\r\n    saveVideoInputDeviceId,\r\n    saveUsername,\r\n  };\r\n}\r\n","import * as React from 'react';\r\nimport { LocalParticipant } from 'livekit-client';\r\nimport type { Participant, Room } from 'livekit-client';\r\nimport { encryptionStatusObservable } from '@livekit/components-core';\r\nimport { useEnsureParticipant, useEnsureRoom } from '../context';\r\nimport { useObservableState } from './internal';\r\n\r\n/**\r\n * @alpha\r\n */\r\nexport interface UseIsEncryptedOptions {\r\n  room?: Room;\r\n}\r\n\r\n/**\r\n * @alpha\r\n */\r\nexport function useIsEncrypted(participant?: Participant, options: UseIsEncryptedOptions = {}) {\r\n  const p = useEnsureParticipant(participant);\r\n\r\n  const room = useEnsureRoom(options.room);\r\n\r\n  const observer = React.useMemo(() => encryptionStatusObservable(room, p), [room, p]);\r\n  const isEncrypted = useObservableState(\r\n    observer,\r\n    p.isLocal ? (p as LocalParticipant).isE2EEEnabled : !!p?.isEncrypted,\r\n  );\r\n  return isEncrypted;\r\n}\r\n","import * as React from 'react';\r\nimport type { LocalAudioTrack, RemoteAudioTrack, AudioAnalyserOptions } from 'livekit-client';\r\nimport { Track, createAudioAnalyser } from 'livekit-client';\r\nimport {\r\n  type TrackReference,\r\n  isTrackReference,\r\n  type TrackReferenceOrPlaceholder,\r\n} from '@livekit/components-core';\r\n\r\n/**\r\n * @alpha\r\n * Hook for tracking the volume of an audio track using the Web Audio API.\r\n */\r\nexport function useTrackVolume(\r\n  trackOrTrackReference?: LocalAudioTrack | RemoteAudioTrack | TrackReference,\r\n  options: AudioAnalyserOptions = { fftSize: 32, smoothingTimeConstant: 0 },\r\n) {\r\n  const track = isTrackReference(trackOrTrackReference)\r\n    ? <LocalAudioTrack | RemoteAudioTrack | undefined>trackOrTrackReference.publication.track\r\n    : trackOrTrackReference;\r\n  const [volume, setVolume] = React.useState(0);\r\n  React.useEffect(() => {\r\n    if (!track || !track.mediaStream) {\r\n      return;\r\n    }\r\n\r\n    const { cleanup, analyser } = createAudioAnalyser(track, options);\r\n\r\n    const bufferLength = analyser.frequencyBinCount;\r\n    const dataArray = new Uint8Array(bufferLength);\r\n\r\n    const updateVolume = () => {\r\n      analyser.getByteFrequencyData(dataArray);\r\n      let sum = 0;\r\n      for (let i = 0; i < dataArray.length; i++) {\r\n        const a = dataArray[i];\r\n        sum += a * a;\r\n      }\r\n      setVolume(Math.sqrt(sum / dataArray.length) / 255);\r\n    };\r\n\r\n    const interval = setInterval(updateVolume, 1000 / 30);\r\n\r\n    return () => {\r\n      cleanup();\r\n      clearInterval(interval);\r\n    };\r\n  }, [track, track?.mediaStream, JSON.stringify(options)]);\r\n\r\n  return volume;\r\n}\r\n\r\nconst normalizeFrequencies = (frequencies: Float32Array) => {\r\n  const normalizeDb = (value: number) => {\r\n    const minDb = -100;\r\n    const maxDb = -10;\r\n    let db = 1 - (Math.max(minDb, Math.min(maxDb, value)) * -1) / 100;\r\n    db = Math.sqrt(db);\r\n\r\n    return db;\r\n  };\r\n\r\n  // Normalize all frequency values\r\n  return frequencies.map((value) => {\r\n    if (value === -Infinity) {\r\n      return 0;\r\n    }\r\n    return normalizeDb(value);\r\n  });\r\n};\r\n\r\n/**\r\n * Interface for configuring options for the useMultibandTrackVolume hook.\r\n * @alpha\r\n */\r\nexport interface MultiBandTrackVolumeOptions {\r\n  bands?: number;\r\n  /**\r\n   * cut off of frequency bins on the lower end\r\n   * Note: this is not a frequency measure, but in relation to analyserOptions.fftSize,\r\n   */\r\n  loPass?: number;\r\n  /**\r\n   * cut off of frequency bins on the higher end\r\n   * Note: this is not a frequency measure, but in relation to analyserOptions.fftSize,\r\n   */\r\n  hiPass?: number;\r\n  /**\r\n   * update should run every x ms\r\n   */\r\n  updateInterval?: number;\r\n  analyserOptions?: AnalyserOptions;\r\n}\r\n\r\nconst multibandDefaults = {\r\n  bands: 5,\r\n  loPass: 100,\r\n  hiPass: 600,\r\n  updateInterval: 32,\r\n  analyserOptions: { fftSize: 2048 },\r\n} as const satisfies MultiBandTrackVolumeOptions;\r\n\r\n/**\r\n * Hook for tracking the volume of an audio track across multiple frequency bands using the Web Audio API.\r\n * @alpha\r\n */\r\nexport function useMultibandTrackVolume(\r\n  trackOrTrackReference?: LocalAudioTrack | RemoteAudioTrack | TrackReferenceOrPlaceholder,\r\n  options: MultiBandTrackVolumeOptions = {},\r\n) {\r\n  const track =\r\n    trackOrTrackReference instanceof Track\r\n      ? trackOrTrackReference\r\n      : <LocalAudioTrack | RemoteAudioTrack | undefined>trackOrTrackReference?.publication?.track;\r\n  const opts = { ...multibandDefaults, ...options };\r\n  const [frequencyBands, setFrequencyBands] = React.useState<Array<number>>(\r\n    new Array(opts.bands).fill(0),\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    if (!track || !track?.mediaStream) {\r\n      return;\r\n    }\r\n    const { analyser, cleanup } = createAudioAnalyser(track, opts.analyserOptions);\r\n\r\n    const bufferLength = analyser.frequencyBinCount;\r\n    const dataArray = new Float32Array(bufferLength);\r\n\r\n    const updateVolume = () => {\r\n      analyser.getFloatFrequencyData(dataArray);\r\n      let frequencies: Float32Array = new Float32Array(dataArray.length);\r\n      for (let i = 0; i < dataArray.length; i++) {\r\n        frequencies[i] = dataArray[i];\r\n      }\r\n      frequencies = frequencies.slice(options.loPass, options.hiPass);\r\n\r\n      const normalizedFrequencies = normalizeFrequencies(frequencies); // is this needed ?\r\n      const chunkSize = Math.ceil(normalizedFrequencies.length / opts.bands); // we want logarithmic chunking here\r\n      const chunks: Array<number> = [];\r\n      for (let i = 0; i < opts.bands; i++) {\r\n        const summedVolumes = normalizedFrequencies\r\n          .slice(i * chunkSize, (i + 1) * chunkSize)\r\n          .reduce((acc, val) => (acc += val), 0);\r\n        chunks.push(summedVolumes / chunkSize);\r\n      }\r\n\r\n      setFrequencyBands(chunks);\r\n    };\r\n\r\n    const interval = setInterval(updateVolume, opts.updateInterval);\r\n\r\n    return () => {\r\n      cleanup();\r\n      clearInterval(interval);\r\n    };\r\n  }, [track, track?.mediaStream, JSON.stringify(options)]);\r\n\r\n  return frequencyBands;\r\n}\r\n\r\n/**\r\n * @alpha\r\n */\r\nexport interface AudioWaveformOptions {\r\n  barCount?: number;\r\n  volMultiplier?: number;\r\n  updateInterval?: number;\r\n}\r\n\r\nconst waveformDefaults = {\r\n  barCount: 120,\r\n  volMultiplier: 5,\r\n  updateInterval: 20,\r\n} as const satisfies AudioWaveformOptions;\r\n\r\n/**\r\n * @alpha\r\n */\r\nexport function useAudioWaveform(\r\n  trackOrTrackReference?: LocalAudioTrack | RemoteAudioTrack | TrackReferenceOrPlaceholder,\r\n  options: AudioWaveformOptions = {},\r\n) {\r\n  const track =\r\n    trackOrTrackReference instanceof Track\r\n      ? trackOrTrackReference\r\n      : <LocalAudioTrack | RemoteAudioTrack | undefined>trackOrTrackReference?.publication?.track;\r\n  const opts = { ...waveformDefaults, ...options };\r\n\r\n  const aggregateWave = React.useRef(new Float32Array());\r\n  const timeRef = React.useRef(performance.now());\r\n  const updates = React.useRef(0);\r\n  const [bars, setBars] = React.useState<number[]>([]);\r\n\r\n  const onUpdate = React.useCallback((wave: Float32Array) => {\r\n    setBars(\r\n      Array.from(\r\n        filterData(wave, opts.barCount).map((v) => Math.sqrt(v) * opts.volMultiplier),\r\n        // wave.slice(0, opts.barCount).map((v) => sigmoid(v * opts.volMultiplier, 0.08, 0.2)),\r\n      ),\r\n    );\r\n  }, []);\r\n\r\n  React.useEffect(() => {\r\n    if (!track || !track?.mediaStream) {\r\n      return;\r\n    }\r\n    const { analyser, cleanup } = createAudioAnalyser(track, {\r\n      fftSize: getFFTSizeValue(opts.barCount),\r\n    });\r\n\r\n    const bufferLength = getFFTSizeValue(opts.barCount);\r\n    const dataArray = new Float32Array(bufferLength);\r\n\r\n    const update = () => {\r\n      updateWaveform = requestAnimationFrame(update);\r\n      analyser.getFloatTimeDomainData(dataArray);\r\n      aggregateWave.current.map((v, i) => v + dataArray[i]);\r\n      updates.current += 1;\r\n\r\n      if (performance.now() - timeRef.current >= opts.updateInterval) {\r\n        const newData = dataArray.map((v) => v / updates.current);\r\n        onUpdate(newData);\r\n        timeRef.current = performance.now();\r\n        updates.current = 0;\r\n      }\r\n    };\r\n\r\n    let updateWaveform = requestAnimationFrame(update);\r\n\r\n    return () => {\r\n      cleanup();\r\n      cancelAnimationFrame(updateWaveform);\r\n    };\r\n  }, [track, track?.mediaStream, JSON.stringify(options), onUpdate]);\r\n\r\n  return {\r\n    bars,\r\n  };\r\n}\r\n\r\nfunction getFFTSizeValue(x: number) {\r\n  if (x < 32) return 32;\r\n  else return pow2ceil(x);\r\n}\r\n\r\n// function sigmoid(x: number, k = 2, s = 0) {\r\n//   return 1 / (1 + Math.exp(-(x - s) / k));\r\n// }\r\n\r\nfunction pow2ceil(v: number) {\r\n  let p = 2;\r\n  while ((v >>= 1)) {\r\n    p <<= 1;\r\n  }\r\n  return p;\r\n}\r\n\r\nfunction filterData(audioData: Float32Array, numSamples: number) {\r\n  const blockSize = Math.floor(audioData.length / numSamples); // the number of samples in each subdivision\r\n  const filteredData = new Float32Array(numSamples);\r\n  for (let i = 0; i < numSamples; i++) {\r\n    const blockStart = blockSize * i; // the location of the first sample in the block\r\n    let sum = 0;\r\n    for (let j = 0; j < blockSize; j++) {\r\n      sum = sum + Math.abs(audioData[blockStart + j]); // find the sum of all the samples in the block\r\n    }\r\n    filteredData[i] = sum / blockSize; // divide the sum by the block size to get the average\r\n  }\r\n  return filteredData;\r\n}\r\n\r\n// function normalizeData(audioData: Float32Array) {\r\n//   const multiplier = Math.pow(Math.max(...audioData), -1);\r\n//   return audioData.map((n) => n * multiplier);\r\n// }\r\n"],"names":["useLatest","current","storedValue","React","useResizeObserver","target","callback","resizeObserver","getResizeObserver","storedCallback","didUnsubscribe","targetEl","cb","entry","observer","createResizeObserver","ticking","allEntries","callbacks","entries","obs","triggered","i","cbs","cbIndex","_resizeObserver","useSize","size","setSize","width","height","resizeCallback","useObservableState","observable","startWith","resetWhenObservableChanges","state","setState","subscription","chatReducer","action","newState","pinReducer","LayoutContext","useLayoutContext","layoutContext","useEnsureLayoutContext","layout","useMaybeLayoutContext","useCreateLayoutContext","pinState","pinDispatch","PIN_DEFAULT_STATE","widgetState","widgetDispatch","WIDGET_DEFAULT_STATE","useEnsureCreateLayoutContext","TrackRefContext","useTrackRefContext","trackReference","useMaybeTrackRefContext","useEnsureTrackRef","trackRef","context","ref","ParticipantContext","useParticipantContext","participant","useMaybeParticipantContext","useEnsureParticipant","trackContext","p","r","t","f","n","o","clsx","chain","args","e","mergeProps","result","props","key","a","b","useConnectionQualityIndicator","options","className","connectionQualityObserver","setupConnectionQualityIndicator","quality","ConnectionQuality","useConnectionState","room","useEnsureRoom","connectionStateObserver","useDisconnectButton","useRoomContext","connectionState","disconnect","setupDisconnectButton","ConnectionState","useFacingMode","LocalTrackPublication","localTrack","facingMode","facingModeFromLocalTrack","useFocusToggle","setupFocusToggle","inFocus","isTrackReferencePinned","event","_a","_c","_b","_e","_d","useGridLayout","gridElement","trackCount","gridLayouts","GRID_LAYOUTS","selectGridLayout","useIsMuted","sourceOrTrackRef","passedParticipant","isMuted","setIsMuted","listener","mutedObserver","getTrackReferenceId","useIsSpeaking","createIsSpeakingObserver","isProp","prop","mergePropsReactAria","cloneSingleChild","children","child","warnAboutMissingStyles","el","log","roomOptionsStringifyReplacer","val","useLocalParticipantPermissions","permissionObserver","participantPermissionObserver","useMediaDeviceSelect","kind","track","requestPermissions","onError","roomContext","useMaybeRoomContext","roomFallback","Room","deviceObserver","createMediaDeviceObserver","devices","currentDeviceId","setCurrentDeviceId","activeDeviceObservable","setActiveMediaDevice","setupDeviceSelector","deviceId","useMediaDevices","useVisualStableUpdate","trackReferences","maxItemsOnPage","lastTrackRefs","lastMaxItemsOnPage","layoutChanged","sortedTrackRefs","sortTrackReferences","updatedTrackRefs","updatePages","error","usePagination","itemPerPage","currentPage","setCurrentPage","totalPageCount","lastItemIndex","firstItemIndex","changePage","direction","goToPage","num","tracksOnPage","useParticipantTile","onParticipantClick","disableSpeakingIndicator","htmlProps","mergedProps","setupParticipantTile","micTrack","Track","micRef","isVideoMuted","isAudioMuted","isSpeaking","usePinnedTracks","useStartAudio","roomEnsured","roomAudioPlaybackAllowedObservable","handleStartAudioPlayback","setupStartAudio","canPlayAudio","useStartVideo","roomVideoPlaybackAllowedObservable","handleStartVideoPlayback","setupStartVideo","canPlayVideo","useSwipe","element","touchStart","touchEnd","minSwipeDistance","onTouchStart","onTouchMove","onTouchEnd","distance","isLeftSwipe","isRightSwipe","elementCopy","useChatToggle","dispatch","setupChatToggle","useTrackMutedIndicator","mediaMutedObserver","setupTrackMutedIndicator","useTrackToggle","source","onChange","initialState","captureOptions","publishOptions","onDeviceError","rest","userInteractionRef","toggle","pendingObserver","enabledObserver","setupMediaToggle","setupManualToggle","pending","enabled","newProps","clickHandler","evt","useTracks","sources","setTrackReferences","participants","setParticipants","sources_","s","isSourceWitOptions","trackReferencesObservable","isSourcesWithOptions","requirePlaceholder","requiredPlaceholders","trackReferencesWithPlaceholders","placeholderSource","publication","placeholder","difference","setA","setB","_difference","elem","placeholderMap","sourcesThatNeedPlaceholder","sourceWithOption","sourcesOfSubscribedTracks","pub","trackSource","placeholderNeededForThisParticipant","useChat","isDisconnected","setup","setupChat","isSending","chatMessages","usePersistentUserChoices","userChoices","setSettings","loadUserChoices","saveAudioInputEnabled","isEnabled","prev","saveVideoInputEnabled","saveAudioInputDeviceId","saveVideoInputDeviceId","saveUsername","username","saveUserChoices","useIsEncrypted","encryptionStatusObservable","useTrackVolume","trackOrTrackReference","isTrackReference","volume","setVolume","cleanup","analyser","createAudioAnalyser","bufferLength","dataArray","interval","sum","normalizeFrequencies","frequencies","normalizeDb","value","db","multibandDefaults","useMultibandTrackVolume","opts","frequencyBands","setFrequencyBands","normalizedFrequencies","chunkSize","chunks","summedVolumes","acc","waveformDefaults","useAudioWaveform","aggregateWave","timeRef","updates","bars","setBars","onUpdate","wave","filterData","v","getFFTSizeValue","update","updateWaveform","newData","x","pow2ceil","audioData","numSamples","blockSize","filteredData","blockStart","j"],"mappings":"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","x_google_ignoreList":[7]}